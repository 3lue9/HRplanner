[{"/home/massimiliano/Documents/HRplanner/src/index.tsx":"1","/home/massimiliano/Documents/HRplanner/src/reportWebVitals.ts":"2","/home/massimiliano/Documents/HRplanner/src/App.tsx":"3","/home/massimiliano/Documents/HRplanner/src/services/auth.service.ts":"4","/home/massimiliano/Documents/HRplanner/src/common/EventBus.ts":"5","/home/massimiliano/Documents/HRplanner/src/components/profile.component.tsx":"6","/home/massimiliano/Documents/HRplanner/src/components/board-user.component.tsx":"7","/home/massimiliano/Documents/HRplanner/src/components/board-moderator.component.tsx":"8","/home/massimiliano/Documents/HRplanner/src/components/board-admin.component.tsx":"9","/home/massimiliano/Documents/HRplanner/src/components/login.component.tsx":"10","/home/massimiliano/Documents/HRplanner/src/components/register.component.tsx":"11","/home/massimiliano/Documents/HRplanner/src/components/home.component.tsx":"12","/home/massimiliano/Documents/HRplanner/src/services/user.service.ts":"13","/home/massimiliano/Documents/HRplanner/src/utils/supabaseClient.ts":"14","/home/massimiliano/Documents/HRplanner/src/services/auth-header.ts":"15"},{"size":573,"mtime":1720598166442,"results":"16","hashOfConfig":"17"},{"size":425,"mtime":1720598166442,"results":"18","hashOfConfig":"17"},{"size":4433,"mtime":1720598166441,"results":"19","hashOfConfig":"17"},{"size":3103,"mtime":1720599340279,"results":"20","hashOfConfig":"17"},{"size":380,"mtime":1720598166442,"results":"21","hashOfConfig":"17"},{"size":2107,"mtime":1720598166442,"results":"22","hashOfConfig":"17"},{"size":1069,"mtime":1720598166442,"results":"23","hashOfConfig":"17"},{"size":1075,"mtime":1720598166442,"results":"24","hashOfConfig":"17"},{"size":1071,"mtime":1720598166442,"results":"25","hashOfConfig":"17"},{"size":3615,"mtime":1720598166442,"results":"26","hashOfConfig":"17"},{"size":4756,"mtime":1720598578396,"results":"27","hashOfConfig":"17"},{"size":832,"mtime":1720598166442,"results":"28","hashOfConfig":"17"},{"size":522,"mtime":1720598166442,"results":"29","hashOfConfig":"17"},{"size":412,"mtime":1720598166443,"results":"30","hashOfConfig":"17"},{"size":517,"mtime":1720598166442,"results":"31","hashOfConfig":"17"},{"filePath":"32","messages":"33","suppressedMessages":"34","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"1fgvaym",{"filePath":"35","messages":"36","suppressedMessages":"37","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"38","messages":"39","suppressedMessages":"40","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"41"},{"filePath":"42","messages":"43","suppressedMessages":"44","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"45"},{"filePath":"46","messages":"47","suppressedMessages":"48","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"49","messages":"50","suppressedMessages":"51","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"52","messages":"53","suppressedMessages":"54","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"55","messages":"56","suppressedMessages":"57","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"58","messages":"59","suppressedMessages":"60","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"61","messages":"62","suppressedMessages":"63","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"64","messages":"65","suppressedMessages":"66","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"67","messages":"68","suppressedMessages":"69","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"70"},{"filePath":"71","messages":"72","suppressedMessages":"73","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"74","messages":"75","suppressedMessages":"76","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"77","messages":"78","suppressedMessages":"79","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/home/massimiliano/Documents/HRplanner/src/index.tsx",[],[],"/home/massimiliano/Documents/HRplanner/src/reportWebVitals.ts",[],[],"/home/massimiliano/Documents/HRplanner/src/App.tsx",["80"],[],"import { Component } from \"react\";\nimport { Routes, Route, Link } from \"react-router-dom\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"./App.css\";\n\nimport AuthService from \"./services/auth.service\";\nimport IUser from './types/user.type';\nimport Profile from \"./components/profile.component\";\nimport BoardUser from \"./components/board-user.component\";\nimport BoardModerator from \"./components/board-moderator.component\";\nimport BoardAdmin from \"./components/board-admin.component\";\n\nimport EventBus from \"./common/EventBus\";\n\nimport Login from \"./components/login.component\";\nimport Register from \"./components/register.component\";\nimport Home from \"./components/home.component\";\nimport User from \"./components/user.component\";\n\n\n\ntype Props = {};\n\ntype State = {\n  showModeratorBoard: boolean,\n  showAdminBoard: boolean,\n  currentUser: IUser | undefined\n}\n\nclass App extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.logOut = this.logOut.bind(this);\n\n    this.state = {\n      showModeratorBoard: false,\n      showAdminBoard: false,\n      currentUser: undefined,\n    };\n  }\n\n  async componentDidMount() {\n    const user = await AuthService.getCurrentUser();\n\n    if (user) {\n      this.setState({\n        currentUser: user,\n        showModeratorBoard: user.roles.includes(\"ROLE_MODERATOR\"),\n        showAdminBoard: user.roles.includes(\"ROLE_ADMIN\"),\n      });\n    }\n\n    EventBus.on(\"logout\", this.logOut);\n  }\n\n  componentWillUnmount() {\n    EventBus.remove(\"logout\", this.logOut);\n  }\n\n  logOut() {\n    AuthService.logout();\n    this.setState({\n      showModeratorBoard: false,\n      showAdminBoard: false,\n      currentUser: undefined,\n    });\n  }\n\n  render() {\n    const { currentUser, showModeratorBoard, showAdminBoard } = this.state;\n\n    return (\n      <div>\n        <nav className=\"navbar navbar-expand navbar-dark bg-dark\">\n          <Link to={\"/\"} className=\"navbar-brand\">\n            HRplanner\n          </Link>\n          <div className=\"navbar-nav mr-auto\">\n            <li className=\"nav-item\">\n              <Link to={\"/home\"} className=\"nav-link\">\n                Home\n              </Link>\n            </li>\n\n            {showModeratorBoard && (\n              <li className=\"nav-item\">\n                <Link to={\"/mod\"} className=\"nav-link\">\n                  Moderator Board\n                </Link>\n              </li>\n            )}\n\n            {showAdminBoard && (\n              <li className=\"nav-item\">\n                <Link to={\"/admin\"} className=\"nav-link\">\n                  Admin Board\n                </Link>\n              </li>\n            )}\n\n            {currentUser && (\n              <li className=\"nav-item\">\n                <Link to={\"/user\"} className=\"nav-link\">\n                  User\n                </Link>\n              </li>\n            )}\n          </div>\n\n          {currentUser ? (\n            <div className=\"navbar-nav ml-auto\">\n              <li className=\"nav-item\">\n                <Link to={\"/profile\"} className=\"nav-link\">\n                  {currentUser.username}\n                </Link>\n              </li>\n              <li className=\"nav-item\">\n                <a href=\"/login\" className=\"nav-link\" onClick={this.logOut}>\n                  LogOut\n                </a>\n              </li>\n            </div>\n          ) : (\n            <div className=\"navbar-nav ml-auto\">\n              <li className=\"nav-item\">\n                <Link to={\"/login\"} className=\"nav-link\">\n                  Login\n                </Link>\n              </li>\n\n              <li className=\"nav-item\">\n                <Link to={\"/register\"} className=\"nav-link\">\n                  Sign Up\n                </Link>\n              </li>\n            </div>\n          )}\n        </nav>\n\n        <div className=\"container mt-3\">\n          <Routes>\n            <Route path=\"/\" element={<Home />} />\n            <Route path=\"/home\" element={<Home />} />\n            <Route path=\"/login\" element={<Login />} />\n            <Route path=\"/register\" element={<Register />} />\n            <Route path=\"/profile\" element={<Profile />} />\n            <Route path=\"/user\" element={<BoardUser />} />\n            <Route path=\"/mod\" element={<BoardModerator />} />\n            <Route path=\"/admin\" element={<BoardAdmin />} />\n          </Routes>\n        </div>\n\n        { /*<AuthVerify logOut={this.logOut}/> */}\n      \n      </div>\n    );\n  }\n}\n\nexport default App;\n","/home/massimiliano/Documents/HRplanner/src/services/auth.service.ts",["81"],[],"import { supabase } from \"../utils/supabaseClient\";\nimport IUser from \"../types/user.type\";\n\nclass AuthService {\n  async login(email: string, password: string) {\n    console.log(`Logging in with email: ${email}`);\n    const { data, error } = await this.withRetry(() => \n      supabase.auth.signInWithPassword({ email, password })\n    );\n\n    if (error) {\n      console.error('Error logging in:', error);\n      throw error;\n    }\n\n    return data;\n  }\n\n  async logout() {\n    console.log('Logging out');\n    const { error } = await supabase.auth.signOut();\n\n    if (error) {\n      console.error('Error logging out:', error);\n      throw error;\n    }\n  }\n\n  async register(email: string, password: string, displayName: string) {\n    console.log(`Registering with email: ${email}`);\n    const { data, error } = await this.withRetry(() => \n      supabase.auth.signUp({ email, password })\n    );\n\n    if (error) {\n      console.error('Error signing up:', error);\n      throw error;\n    }\n\n    if (data.user) {\n      const updateError = await this.createProfile(data.user.id, displayName);\n      if (updateError) {\n        console.error('Error creating profile:', updateError);\n        throw updateError;\n      }\n    }\n\n    return data;\n  }\n\n  async createProfile(userId: string, displayName: string) {\n    const { error } = await this.withRetry(() => \n      supabase.from('profiles').insert({ id: userId, display_name: displayName })\n    );\n\n    return error;\n  }\n\n  async getCurrentUser(): Promise<IUser | null> {\n    console.log('Getting current user');\n    const { data, error } = await this.withRetry(() => supabase.auth.getUser());\n\n    if (error) {\n      console.error('Error getting current user:', error);\n      throw error;\n    }\n\n    const user = data.user;\n    if (user) {\n      const { data: profile, error: profileError } = await this.withRetry(() => \n        supabase.from('profiles').select('display_name').eq('id', user.id).single()\n      );\n\n      if (profileError) {\n        console.error('Error fetching user profile:', profileError);\n        throw profileError;\n      }\n\n      const email = user.email || '';\n      return {\n        id: user.id,\n        email,\n        roles: [\"ROLE_USER\"], // Example roles, adjust as needed\n        username: profile.display_name, // Use display_name as username\n      };\n    }\n\n    return null;\n  }\n\n  async withRetry(func: Function, retries = 5, delay = 1000) {\n    for (let i = 0; i < retries; i++) {\n      try {\n        return await func();\n      } catch (error: any) {\n        if (error.status === 429 && i < retries - 1) {\n          // 429 status code means rate limit exceeded\n          console.log(`Rate limit exceeded. Retrying in ${delay}ms...`);\n          await new Promise(resolve => setTimeout(resolve, delay));\n          delay *= 2; // Exponential backoff\n        } else {\n          if (error.status === 429) {\n            // Inform the user about the rate limit\n            throw new Error(\"Rate limit exceeded. Please try again later.\");\n          }\n          throw error;\n        }\n      }\n    }\n  }\n}\n\nexport default new AuthService();\n","/home/massimiliano/Documents/HRplanner/src/common/EventBus.ts",[],[],"/home/massimiliano/Documents/HRplanner/src/components/profile.component.tsx",[],[],"/home/massimiliano/Documents/HRplanner/src/components/board-user.component.tsx",[],[],"/home/massimiliano/Documents/HRplanner/src/components/board-moderator.component.tsx",[],[],"/home/massimiliano/Documents/HRplanner/src/components/board-admin.component.tsx",[],[],"/home/massimiliano/Documents/HRplanner/src/components/login.component.tsx",[],[],"/home/massimiliano/Documents/HRplanner/src/components/register.component.tsx",[],[],"/home/massimiliano/Documents/HRplanner/src/components/home.component.tsx",["82"],[],"import { Component } from \"react\";\n\nimport UserService from \"../services/user.service\";\n\ntype Props = {};\n\ntype State = {\n  content: string;\n}\n\nexport default class Home extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n\n    this.state = {\n      content: \"\"\n    };\n  }\n\n  componentDidMount() {\n    UserService.getPublicContent().then(\n      response => {\n        this.setState({\n          content: response.data\n        });\n      },\n      error => {\n        this.setState({\n          content:\n            (error.response && error.response.data) ||\n            error.message ||\n            error.toString()\n        });\n     }\n    );\n  }\n\n  render() {\n    return (\n      <div className=\"container\">\n        <header className=\"jumbotron\">\n          <h3></h3>\n        </header>\n      </div>\n    );\n  }\n}\n","/home/massimiliano/Documents/HRplanner/src/services/user.service.ts",[],[],"/home/massimiliano/Documents/HRplanner/src/utils/supabaseClient.ts",[],[],"/home/massimiliano/Documents/HRplanner/src/services/auth-header.ts",[],[],{"ruleId":"83","severity":1,"message":"84","line":18,"column":8,"nodeType":"85","messageId":"86","endLine":18,"endColumn":12},{"ruleId":"87","severity":1,"message":"88","line":99,"column":29,"nodeType":"89","messageId":"90","endLine":99,"endColumn":66},{"ruleId":"91","severity":1,"message":"92","line":42,"column":11,"nodeType":"93","endLine":42,"endColumn":15},"@typescript-eslint/no-unused-vars","'User' is defined but never used.","Identifier","unusedVar","no-loop-func","Function declared in a loop contains unsafe references to variable(s) 'delay'.","ArrowFunctionExpression","unsafeRefs","jsx-a11y/heading-has-content","Headings must have content and the content must be accessible by a screen reader.","JSXOpeningElement"]